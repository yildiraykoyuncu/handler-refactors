<!DOCTYPE html>
<html>

<head>
    <title>list items</title>
    <meta charset="utf-8">

    <style>
        .centered {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }
    </style>

    <script src='../../lib/chai.js'></script>
    <script src='../../lib/describe-it.js'></script>

    <script id='logic'>
        'use strict';

        const expect = chai.expect;

        /**
         * Takes and array of strings as an argument and returns a string listing all strings in the array.
         * 
         * @param {string[]}
         * @returns {string}
         */
        const list = (arrOfItems) => {
            if (!Array.isArray(arrOfItems)) {
                throw new TypeError('arrOfItems is not an array');
            }
            if (!arrOfItems.every(item => typeof item === 'string')) {
                throw new TypeError('arrOfItems does not contain only strings');
            }

            let stringList = '';
            for (const input of arrOfItems) {
                stringList += `\n- ${input}`;
            };

            return stringList;
        };

        describe('list: generates a list string from an array of strings', () => {
            describe('list: correctly lists items', () => {
                it('an empty array returns an empty string', () => {
                    const expected = '';
                    const actual = list([]);
                    expect(actual).to.equal(expected);
                });
                it('can list a single item', () => {
                    const expected = '\n- hi';
                    const actual = list(['hi']);
                    expect(actual).to.equal(expected);
                });
                it('can list many items', () => {
                    const expected = '\n- a\n- b\n- c\n- d\n- e';
                    const actual = list(['a', 'b', 'c', 'd', 'e']);
                    expect(actual).to.equal(expected);
                });
            });
            describe('list: uses arguments correctly', () => {
                it('throws an error if the argument is not an array', () => {
                    const shouldThrow = () => list(':)');
                    expect(shouldThrow).to.throw(TypeError, 'arrOfItems is not an array');
                });
                it('throws an error if not all entries are strings', () => {
                    const shouldThrow = () => list(['a', 'b', true, 'c']);
                    expect(shouldThrow).to.throw(TypeError, 'arrOfItems does not contain only strings');
                });
                it('does not modify the array argument', () => {
                    const arg = ['a', 'b', 'c', 'd'];
                    list(arg);
                    expect(arg).to.deep.equal(['a', 'b', 'c', 'd']);
                });
            });
        });
    </script>
    <script id='handler'>
        'use strict';

        const listHandler = () => {

            // read & process user input
            const allInputs = [];
            let acceptingInput = true;
            while (acceptingInput) {
                const nextInput = prompt('enter a list item');
                if (nextInput !== null) {
                    allInputs.push(nextInput);
                } else {
                    acceptingInput = false;
                }
            };

            // execute core logic
            let result = list(allInputs)

            // communicate result to user
            const message = `all items:${result}`;
            alert(message);
        }
    </script>
</head>

<body>
    <main id='user-interface' class='centered'>
        <button onclick='listHandler()'>list items</button>
    </main>
</body>

</html>